<h1 class="title">Wavelength</h1>

<div class="row">
  <div class="col s2"></div>
  <div class="col s8">
    <div class="card">
      <div class="card-content">
        <div class="row">
          <form class="col s12">
            <div class="row">
              <div class="input-field col s12">
                <input id="song_name" type="text" value="{{title}}">
                <label for="song_name"></label>Song Name
              </div>
            </div>
            <div class="row">
              <div class="input-field col s12">
                <input id="artist_name" type="text" value="{{artist}}">
                <label for="artist_name"></label>Artist Name
              </div>
            </div>
            <div class="row">
              <div class="input-field col s12">
                <input id="spotify_URI" type="text" value="{{url}}">
                <label for="spotify_URI"></label>Spotify URI
              </div>
            </div>
            <input type="hidden" value={{id}} id="song-id" />
          </form>
        </div>
        <button class="btn waves-effect waves-light" type="submit" name="action" id="submit-button">Submit
          <i class="material-icons right">send</i>
        </button>
      </div>
    </div>
  </div>
</div>



<script>

  $(document).ready(function () {
    var songName = $("#song_name");
    var artistName = $("#artist_name");
    var spotifyURI = $("#spotify_URI");
    var submitButton = $("#submit-button");

    submitButton.on("click", function (event) {
      event.preventDefault();
      spotifyCode = $("#spotify_URI").val();
      spotify_URI = spotifyCode.substring(14);

      const song = {
        title: $("#song_name").val(),
        artist: $("#artist_name").val(),
        url: spotify_URI
      };

      const id = $("#song-id").val();

      $.ajax({
        url: `/api/songs/${id}`,
        method: "PUT",
        data: song
      }).then(response => {
        console.log(response);
        window.location.href = "/songs"
      }).catch(err => {
        console.log(err);
      })
    });
  });
</script>

<style>
  body {
    background-image: URL(https://images.wallpapersden.com/image/download/synthwave-and-retrowave_a2tpbmyUmZqaraWkpJRobWllrWdma2U.jpg);
    background-size: cover;
    background-repeat: no-repeat;
  }

  h1.title {
    text-align: center;
    font-family: 'Faster One', cursive;
    color: rgb(238, 12, 170);
    font-size: 120px;
  }

  .card {
    text-align: center;
    margin: 9% 20% 0% 20%;
    background-color: rgba(0, 0, 0, 0.842);
    color: #30d7a9;
  }

  .input-field {
    font-size: 24px;
  }
</style>